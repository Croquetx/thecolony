/*--------------------------------- * The Animator * Copyright 1988 by David A. Smith * All Rights Reserved * 111 Gold Meadow Dr. * Cary, NC 27513 *---------------------------------*/#include <Quickdraw.h>#include <WindowMgr.h>#include <MenuMgr.h>#include <EventMgr.h>#include <DialogMgr.h>#include <ToolboxUtil.h>#include <math.h>#define EXT extern #include "adefs.h"/*----------------------------------------------------------------------*/long M1= -1;inits(){int i,j;int message,count;int MaxApplZone();FlushEvents(everyEvent,0);InitGraf(&thePort);InitFonts();InitWindows();InitMenus();TEInit();InitDialogs(restartProc);InitCursor();if(MaxApplZone())SysBeep(1);for(i=0;i<50;i++)MoreMasters();setupmenus(); SetRect(&bounds, 0, 0, 512, 348);SetRect(&size,0,0,470,294);InitSprite();InitBackGround(ltGray,gray);DrawBGWindow();InitAnimate();InitDejaVu();CountAppFiles(&message,&count);if(NIL==(buffer=NewPtr(32000L)))return;/*this buffer should be plenty!*/for(i=0;i<32000;i++)buffer[i]=0;/*clear the buffer*/loadfiles(count);for(i=0;i<7;i++)	{	Curs[i]=GetCursor(256+i);	HLock(Curs[i]);	}for(i=7;i<16;i++)Curs[i]=GetCursor(256);doneflag = FALSE;changed = FALSE;}/*--------------------------------------------------------------------- * Rect r; * MakeBitMap(&r) * Set up the offscreen bit map for use in drawing the sensor. *--------------------------------------------------------------------- */BitMap* MakeBitMap(pr)Rect *pr;{int RowBytes;	/*number of bytes in one row*/Rect brect;			/*off screen bit map boundary rect*/BitMap *offScreen;offScreen=(BitMap *)NewPtr((long)sizeof(BitMap));RowBytes = ((pr->right-pr->left+15)/16)*2;CopyRect(&brect,pr);OffsetRect(&brect,-pr->left,-pr->top);offScreen->baseAddr = (QDPtr)NewPtr((long)RowBytes*(pr->bottom-pr->top));offScreen->rowBytes = RowBytes;CopyRect(&offScreen->bounds,&brect);return(offScreen);}/*--------------------------------------------------------------------- *--------------------------------------------------------------------- */KillBitMap(bm)BitMap *bm;{DisposPtr(bm->baseAddr);DisposPtr(bm);}/*--------------------------------------------------------------------- * Rect r; * GrafPort meta; * MakeGrafPort(&r,&meta) * Set up the offscreen bit map for use in drawing the sensor. *--------------------------------------------------------------------- */MakeGrafPort(pr,meta)Rect *pr;GrafPtr meta;{OpenPort(meta);SetPortBits(MakeBitMap(pr));SetOrigin(0,0);PenMode(patCopy);}