/*--------------------------------- * The Animator * Copyright 1988 by David A. Smith * All Rights Reserved * 111 Gold Meadow Dr. * Cary, NC 27513 *---------------------------------*/#define EXT extern#include "adefs.h"int open=1;/*----------------------------------------------------------------------*/setupmenus(){char *appletitle;int i;myMenus[0]=GetMenu(APPLEMENU);AddResMenu(myMenus[0],'DRVR');myMenus[1]=GetMenu(FILEMENU);myMenus[2]=GetMenu(EDITMENU);for(i=0;i<LASTMENU;i++)InsertMenu(myMenus[i],0);DrawMenuBar();}/*----------------------------------------------------------------------*/DoMenu(mresult)long mresult;	/*the result of a menuselect */{char name[255];int theItem;int theMenu;int refNum;WindowPtr wTest;theMenu=HiWord(mresult);theItem=LoWord(mresult);switch(theMenu)	{	case APPLEMENU:		if(theItem>1)			{			GetItem(myMenus[0],theItem,name);			refNum=OpenDeskAcc(&name);			}		break;	case FILEMENU:		switch(theItem)			{			case 1:/*NEW DATA*/				if(FileQuestion(1))					{					newanim();					changed=FALSE;					if(open==0)						{						ShowWindow(bgWindow);						ShowWindow(sWindow);						ShowWindow(animWindow);						ShowWindow(theWindow);						}					open=1;					}				break;			case 2:/*OPEN FILE*/				if(FileQuestion(1))					{					changed=openanim(changed,0);					if(open==0)						{						ShowWindow(bgWindow);						ShowWindow(sWindow);						ShowWindow(animWindow);						ShowWindow(theWindow);						}					open=1;					}				break;			case 3:/*CLOSE FILE*/				if(open)if(FileQuestion(1))					{					newanim();					HideWindow(theWindow);					HideWindow(animWindow);					HideWindow(bgWindow);					HideWindow(sWindow);					changed=FALSE;					open=0;					}				break;			case 4:/*SAVE FILE*/				if(open)if(changed)changed=saveanim(0,changed,TRUE);				break;			case 5:/*SAVE AS... FILE*/				if(open)changed=saveanim(1,changed,TRUE);				break;			case 6:/*SAVE AS... FILE NO PICT*/				if(open)changed=saveanim(1,changed,FALSE);				break;			case 7:/*QUIT SYSTEM*/				if(FileQuestion(0))					{					doneflag=TRUE;					HideWindow(theWindow);					HideWindow(bgWindow);					HideWindow(sWindow);					HideWindow(animWindow);					}				break;			}		break;	case EDITMENU:		wTest=FrontWindow();		if(!(wTest==theWindow||wTest==sWindow||wTest==bgWindow))			SystemEdit(theItem-1);		else		{		if(wTest==sWindow)		switch(theItem)			{			case 1:/*undo*/				break;			case 3:/*cut*/				Cut();				break;			case 4:/*copy*/				Copy();				break;			case 5:/*paste*/				Paste();				break;			}		else if(wTest==theWindow)			{			switch(theItem)			{			case 1:/*undo*/				break;			case 3:/*cut*/				bgCut();				break;			case 4:/*copy*/				bgCopy();				break;			case 5:/*paste*/				bgPaste();				break;			}		}		}		break;	}HiliteMenu(0);}/*----------------------------------------------------------------------*/int FileQuestion(name)int name;{DialogPtr thedialog;int itemhit=0;if(changed)	{	thedialog = GetNewDialog(2002,(Ptr)NIL,(WindowPtr)(-1));	ModalDialog(NIL,&itemhit);	DisposDialog(thedialog);	switch(itemhit)		{		case 1:/*Save and go on*/			changed=saveanim(name,changed,TRUE);			return(TRUE);			break;		case 2:/*Don't save and go on*/			return(TRUE);			break;		case 3:/*Don't do anything*/			return(FALSE);			break;		}	}return(TRUE);}